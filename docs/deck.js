!function(a,b){typeof exports==='object'&&typeof module!=='undefined'?b():typeof define==='function'&&define.amd?define(b):(b())}(this,(function(){'use strict';var c=35,d=46,e=function(a){var b=null,e=null,f=null,g=0,h='';for(var i=0;i<=a.length;i++){var j=a.charCodeAt(i),k=j===c,l=j===d,m=!j;k||l||m?(g===0?(i===0?(b='div'):(b=h)):g===1?(e=h):f?(f+=' '+h):(f=h),k?(g=1):l&&(g=2),h=''):(h+=a[i])}return{tag:b,id:e,className:f}},f=function(a,b){var c=e(a),d=c.tag,f=c.id,g=c.className,h=b?document.createElementNS(b,d):document.createElement(d);f&&(h.id=f);g&&(b?h.setAttribute('class',g):(h.className=g));return h},g=['onmount','onunmount'],h=function(a,b,c){var d=r(a),e=r(b);b===e&&e.__redom_view&&(b=e.__redom_view);b!==e&&(e.__redom_view=b);var f=e.__redom_mounted,g=e.parentNode;f&&g!==d&&k(b,e,g);c!=null?d.insertBefore(e,r(c)):d.appendChild(e);j(b,e,d,g);return b},i=function(a,b){var c=r(a),d=r(b);b===d&&d.__redom_view&&(b=d.__redom_view);d.parentNode&&(k(b,d,c),c.removeChild(d));return b},j=function(a,b,c,d){var e=b.__redom_lifecycle||(b.__redom_lifecycle={}),f=c===d,h=!1;for(var i=0;i<g.length;i++){var j=g[i];!f&&a!==b&&j in a&&(e[j]=(e[j]||0)+1);e[j]&&(h=!0)}if(!h){b.__redom_mounted=!0;return}var k=c,m=!1;(f||!m&&(k&&k.__redom_mounted))&&(l(b,f?'onremount':'onmount'),m=!0);if(f){return}while(k){var n=k.parentNode,o=k.__redom_lifecycle||(k.__redom_lifecycle={});for(var p in e)o[p]=(o[p]||0)+e[p];!m&&(k===document||n&&n.__redom_mounted)&&(l(k,f?'onremount':'onmount'),m=!0);k=n}},k=function(a,b,c){var d=b.__redom_lifecycle;if(!d){b.__redom_mounted=!1;return}var e=c;b.__redom_mounted&&l(b,'onunmount');while(e){var f=e.__redom_lifecycle||(e.__redom_lifecycle={}),g=!1;for(var h in d)f[h]&&(f[h]-=d[h]),f[h]&&(g=!0);g||(e.__redom_lifecycle=null);e=e.parentNode}},l=function(a,b){b==='onmount'?(a.__redom_mounted=!0):b==='onunmount'&&(a.__redom_mounted=!1);var c=a.__redom_lifecycle;if(!c){return}var d=a.__redom_view,e=0;d&&d[b]&&d[b]();for(var f in c)f&&e++;if(e){var g=a.firstChild;while(g){var h=g.nextSibling;l(g,b);g=h}}},m=function(a,b,c){var d=r(a);if(c!==undefined)d.style[b]=c;else if(s(b))d.setAttribute('style',b);else{for(var e in b)m(d,e,b[e])}},n=function(a,b,c){var d=r(a),e=d instanceof SVGElement;if(c!==undefined)b==='style'?m(d,c):e&&v(c)?(d[b]=c):!e&&(b in d||v(c))?(d[b]=c):d.setAttribute(b,c);else{for(var f in b)n(d,f,b[f])}},o=function(a){return document.createTextNode(a)},p=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d!==0&&!d){continue}typeof d==='function'?d(a):s(d)||u(d)?a.appendChild(o(d)):w(r(d))?h(a,d):d.length?p(a,d):typeof d==='object'&&n(a,d)}},q=function(a){return s(a)?z(a):r(a)},r=function(a){return a.nodeType&&a||!a.el&&a||r(a.el)},s=function(a){return typeof a==='string'},u=function(a){return typeof a==='number'},v=function(a){return typeof a==='function'},w=function(a){return a&&a.nodeType},x={},y=function(a){return x[a]||(x[a]=f(a))},z=function(a){var b=arguments,c=[],d=arguments.length-1;while(d-->0)c[d]=b[d+1];var e;if(s(a))e=y(a).cloneNode(!1);else if(w(a))e=a.cloneNode(!1);else{throw new Error('At least one argument required')};p(e,c);return e};z.extend=function(a){var b=y(a);return z.bind(this,b)};var A=z,B=function(a,b){if(b.length===undefined){return B(a,[b])}var c=r(a),d=c.firstChild;for(var e=0;e<b.length;e++){var f=b[e];if(!f){continue}var g=r(f);if(g===d){d=d.nextSibling;continue}h(a,f,d)}while(d){var j=d.nextSibling;i(a,d);d=j}},C=function(a){return function(b){return b[a]}},D=function e(a,b,c,d){this.__redom_list=!0;this.View=b;this.initData=d;this.views=[];this.el=q(a);c!=null&&(this.lookup={},this.key=v(c)?c:C(c))};D.prototype.update=function c(a,b){var d=this;a===void 0&&(a=[]);var e=this.View,f=this.key,g=f!=null,h=this.initData,j=new Array(a.length),k=this.views,l=f&&{},m=f&&this.lookup;for(var n=0;n<a.length;n++){var o=a[n],p=void 0;if(g){var q=f(o);p=m[q]||new e(h,o,n,a);l[q]=p;p.__redom_id=q}else p=k[n]||new e(h,o,n,a);j[n]=p;var s=r(p.el);s.__redom_view=p;p.update&&p.update(o,n,a,b)}if(g){for(var t=0;t<k.length;t++){var u=k[t].__redom_id;(u in l)||i(d,m[u])}}B(this,j);g&&(this.lookup=l);this.views=j};D.extend=function(a,b,c,d){return D.bind(D,a,b,c,d)};var E=function c(a,b){this.el=o('');this.visible=!1;this.view=null;this._placeholder=this.el;this._View=a;this._initData=b};E.prototype.update=function c(a,b){var d=this._placeholder,e=this.el.parentNode;if(a){if(!this.visible){var f=this._View,g=new f(this._initData);this.el=r(g.el);this.view=g;h(e,g,d);i(e,d)}this.view.update&&this.view.update(b)}else this.visible&&(h(e,d,this.view),i(e,this.view),this.el=d,this.view=null);this.visible=a};var F=function d(a,b,c){this.el=q(a);this.Views=b;this.initData=c};F.prototype.update=function c(a,b){if(a!==this.route){var d=this.Views,e=d[a];this.view=e&&new e(this.initData,b);this.route=a;B(this.el,[this.view])}this.view&&this.view.update&&this.view.update(b,a)};function G(a,b){var c=b.shift();c(function(){b.length?G(a,b):(a.queueing=!1)})}var H=function a(){this.el=A('.deck');this.cards=[];this.queued=[];this.queueing=!1};H.prototype.mount=function b(a){h(a,this);return this};H.prototype.queue=function b(a){this.queued.push(a);if(this.queueing){return this}this.queueing=!0;G(this,this.queued);return this};H.prototype.stack=function a(){var b=this;return this.queue(function(a){b.cards.forEach(function(a,b){a.set({x:-b*a.d,y:-b*a.d,z:b})});a()})};H.prototype.wait=function b(a){return this.queue(function(b){return setTimeout(function(){return b()},a)})};H.prototype.shuffle=function c(){var d=this;return this.queue(function(a){d.cards.forEach(function(b,c){var d=Math.random()<0.5?1:-1,e=d*(Math.random()*50+50);b.tween({delay:c*2,duration:225,ease:'quadInOut',to:{x:e},precision:{x:1},onend:function(){c===0&&a()}})})}).queue(function(c){var e=d.cards.length-1;d.cards.sort(function(a,b){return Math.random()-0.5});d.cards.forEach(function(a,b){a.tween({delay:b*2,duration:225,ease:'quadInOut',to:{x:-b*a.d,y:-b*a.d,z:b},precision:{x:1,y:1,z:0},onend:function(){b===e&&c()}})})})};H.prototype.bySuit=function a(){var b=this;return this.queue(function(a){b.cards.forEach(function(a,b){a.tween({delay:500+b*30,duration:500,ease:'quartInOut',to:{x:(a.value-6)*125,y:(a.suit-1.5)*180},precision:{x:2,y:2,z:0}})})})};H.prototype.unshift=function b(a){this.cards.unshift(a);this.cards.forEach(function(a,b){a.set({z:b})});h(this,a,this.cards[1]);return this};H.prototype.push=function b(a){var c=this.cards.length;a.set({z:c});this.cards.push(a);h(this,a);return this};var I=function(a){return function(b){return Math.pow(b,a)}},J=function(a){return function(b){return 1-Math.abs(Math.pow(b-1,a))}},K=function(a){return function(b){return b<0.5?I(a)(b*2)/2:J(a)(b*2-1)/2+0.5}},L=I(2),M=J(2),N=K(2),O=I(3),P=J(3),Q=K(3),R=I(4),S=J(4),T=K(4),U=I(5),V=J(5),W=K(5),X=function(a){return 1+Math.sin(Math.PI/2*a-Math.PI/2)},Y=function(a){return Math.sin(Math.PI/2*a)},Z=function(a){return(1+Math.sin(Math.PI*a-Math.PI/2))/2},_=function(a){var b=7.5625,c=2.75;if(a<1/c){return b*a*a}if(a<2/c){a-=1.5/c;return b*a*a+0.75}if(a<2.5/c){a-=2.25/c;return b*a*a+0.9375}a-=2.625/c;return b*a*a+0.984375},$=Object.freeze({quadIn:L,quadOut:M,quadInOut:N,cubicIn:O,cubicOut:P,cubicInOut:Q,quartIn:R,quartOut:S,quartInOut:T,quintIn:U,quintOut:V,quintInOut:W,sineIn:X,sineOut:Y,sineInOut:Z,bounce:_}),aa=[],ab=!1,ac=!1,ad=[];function ae(a,b){aa.push(a);if(ac){if(ab){return}else ab=!0}else ac=requestAnimationFrame(af)}function af(a){var b=aa.length;for(var c=0;c<b;c++)aa[c](a);aa.splice(0,b);ab?(ab=!1,ac=requestAnimationFrame(af)):(ac=!1)}function ag(a){for(var b=0;b<ad.length;b++){var c=ad[b],d=c.startTime,e=c.duration,f=c.endTime,g=c.target,h=c.from,i=c.diff,j=c.ease,k=c.precision;if(a<d){continue}var l=a<f?(a-d)/e:1,m=$[j]?$[j](l):l;for(var n in h){var o=h[n]+i[n]*m;k[n]?(g[n]=parseFloat(o.toFixed(k[n]))):n in k?(g[n]=Math.round(o)):(g[n]=o)}g.render&&g.render();a>c.endTime&&(ad.splice(b--,1),c.onend&&c.onend())}ad.length&&ae(ag)}function ah(a,b){var c=b.delay,d=b.duration,e=b.from;e===void 0&&(e={});var f=b.to;f===void 0&&(f={});var g=b.ease;g===void 0&&(g='linear');var h=b.precision;h===void 0&&(h={});var i=b.onend;ae(function(b){var j=b+c,k=j+d,l={};for(var m in e){var n=m in f;n||(f[m]=a[m])}for(var o in f){var p=o in e;p||(e[o]=a[o]);l[o]=f[o]-e[o]}var q={startTime:j,duration:d,endTime:k,ease:g,from:e,diff:l,precision:h,target:a,onend:i};ad.length||ae(ag);ad.push(q)})}var ai='spades hearts clubs diamonds jokers'.split(' '),aj='a 2 3 4 5 6 7 8 9 10 j q k'.split(' '),ak=function b(a){var c=a/13|0,d=a%13,e="img/"+ai[c]+"/"+(c<4?aj[d]:d+1)+".svg";this.i=a;this.suit=c;this.value=d;this.img=e;this.stack=!0;this.data={};this.x=0;this.y=0;this.z=0;this.r=0;this.d=0.25;this.el=A('.card',{style:{backgroundImage:"url("+e+")"}})};ak.prototype.set=function b(a){var c=this;for(var d in a)c[d]=a[d];this.render();return this};ak.prototype.tween=function b(a){var c=a.delay;c===void 0&&(c=0);var d=a.duration;d===void 0&&(d=0);var e=a.ease,f=a.from,g=a.to,h=a.precision,i=a.stack,j=a.onend;this.stack=i;ah(this,{delay:c,duration:d,ease:e,from:f,to:g,precision:h,onend:j});return this};ak.prototype.render=function a(){var b=this,c=b.x,d=b.y,e=b.z,f=b.r,g="translate("+c+"px, "+d+"px)",h=f?" rotate("+f+"deg)":'';this.el.style.transform=g+h;this.el.style.zIndex=e;return this};var al=new H({width:10,height:6});for(var am=0;am<55;am++){var an=new ak(am);al.unshift(an)}al.cards.reverse();al.stack().wait(500).shuffle().shuffle().shuffle().bySuit();al.mount(document.body)}))
