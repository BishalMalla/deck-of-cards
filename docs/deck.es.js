var HASH=35,DOT=46,parseQuery=function(a){var b=null,c=null,d=null,e=0,f='';for(var g=0;g<=a.length;g++){var h=a.charCodeAt(g),i=h===HASH,j=h===DOT,k=!h;i||j||k?(e===0?(g===0?(b='div'):(b=f)):e===1?(c=f):d?(d+=' '+f):(d=f),i?(e=1):j&&(e=2),f=''):(f+=a[g])}return{tag:b,id:c,className:d}},createElement=function(a,b){var c=parseQuery(a),d=c.tag,e=c.id,f=c.className,g=b?document.createElementNS(b,d):document.createElement(d);e&&(g.id=e);f&&(b?g.setAttribute('class',f):(g.className=f));return g},hookNames=['onmount','onunmount'],mount=function(a,b,c){var d=getEl(a),e=getEl(b);b===e&&e.__redom_view&&(b=e.__redom_view);b!==e&&(e.__redom_view=b);var f=e.__redom_mounted,g=e.parentNode;f&&g!==d&&doUnmount(b,e,g);c!=null?d.insertBefore(e,getEl(c)):d.appendChild(e);doMount(b,e,d,g);return b},unmount=function(a,b){var c=getEl(a),d=getEl(b);b===d&&d.__redom_view&&(b=d.__redom_view);d.parentNode&&(doUnmount(b,d,c),c.removeChild(d));return b},doMount=function(a,b,c,d){var e=b.__redom_lifecycle||(b.__redom_lifecycle={}),f=c===d,g=!1;for(var h=0;h<hookNames.length;h++){var i=hookNames[h];!f&&a!==b&&i in a&&(e[i]=(e[i]||0)+1);e[i]&&(g=!0)}if(!g){b.__redom_mounted=!0;return}var j=c,k=!1;(f||!k&&(j&&j.__redom_mounted))&&(trigger(b,f?'onremount':'onmount'),k=!0);if(f){return}while(j){var l=j.parentNode,m=j.__redom_lifecycle||(j.__redom_lifecycle={});for(var n in e)m[n]=(m[n]||0)+e[n];!k&&(j===document||l&&l.__redom_mounted)&&(trigger(j,f?'onremount':'onmount'),k=!0);j=l}},doUnmount=function(a,b,c){var d=b.__redom_lifecycle;if(!d){b.__redom_mounted=!1;return}var e=c;b.__redom_mounted&&trigger(b,'onunmount');while(e){var f=e.__redom_lifecycle||(e.__redom_lifecycle={}),g=!1;for(var h in d)f[h]&&(f[h]-=d[h]),f[h]&&(g=!0);g||(e.__redom_lifecycle=null);e=e.parentNode}},trigger=function(a,b){b==='onmount'?(a.__redom_mounted=!0):b==='onunmount'&&(a.__redom_mounted=!1);var c=a.__redom_lifecycle;if(!c){return}var d=a.__redom_view,e=0;d&&d[b]&&d[b]();for(var f in c)f&&e++;if(e){var g=a.firstChild;while(g){var h=g.nextSibling;trigger(g,b);g=h}}},setStyle=function(a,b,c){var d=getEl(a);if(c!==undefined)d.style[b]=c;else if(isString(b))d.setAttribute('style',b);else{for(var e in b)setStyle(d,e,b[e])}},setAttr=function(a,b,c){var d=getEl(a),e=d instanceof SVGElement;if(c!==undefined)b==='style'?setStyle(d,c):e&&isFunction(c)?(d[b]=c):!e&&(b in d||isFunction(c))?(d[b]=c):d.setAttribute(b,c);else{for(var f in b)setAttr(d,f,b[f])}},text=function(a){return document.createTextNode(a)},parseArguments=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d!==0&&!d){continue}typeof d==='function'?d(a):isString(d)||isNumber(d)?a.appendChild(text(d)):isNode(getEl(d))?mount(a,d):d.length?parseArguments(a,d):typeof d==='object'&&setAttr(a,d)}},ensureEl=function(a){return isString(a)?html(a):getEl(a)},getEl=function(a){return a.nodeType&&a||!a.el&&a||getEl(a.el)},isString=function(a){return typeof a==='string'},isNumber=function(a){return typeof a==='number'},isFunction=function(a){return typeof a==='function'},isNode=function(a){return a&&a.nodeType},htmlCache={},memoizeHTML=function(a){return htmlCache[a]||(htmlCache[a]=createElement(a))},html=function(a){var b=arguments,c=[],d=arguments.length-1;while(d-->0)c[d]=b[d+1];var e;if(isString(a))e=memoizeHTML(a).cloneNode(!1);else if(isNode(a))e=a.cloneNode(!1);else{throw new Error('At least one argument required')};parseArguments(e,c);return e};html.extend=function(a){var b=memoizeHTML(a);return html.bind(this,b)};var el=html,setChildren=function(a,b){if(b.length===undefined){return setChildren(a,[b])}var c=getEl(a),d=c.firstChild;for(var e=0;e<b.length;e++){var f=b[e];if(!f){continue}var g=getEl(f);if(g===d){d=d.nextSibling;continue}mount(a,f,d)}while(d){var h=d.nextSibling;unmount(a,d);d=h}},propKey=function(a){return function(b){return b[a]}},List=function e(a,b,c,d){this.__redom_list=!0;this.View=b;this.initData=d;this.views=[];this.el=ensureEl(a);c!=null&&(this.lookup={},this.key=isFunction(c)?c:propKey(c))};List.prototype.update=function c(a,b){var d=this;a===void 0&&(a=[]);var e=this.View,f=this.key,g=f!=null,h=this.initData,i=new Array(a.length),j=this.views,k=f&&{},l=f&&this.lookup;for(var m=0;m<a.length;m++){var n=a[m],o=void 0;if(g){var p=f(n);o=l[p]||new e(h,n,m,a);k[p]=o;o.__redom_id=p}else o=j[m]||new e(h,n,m,a);i[m]=o;var q=getEl(o.el);q.__redom_view=o;o.update&&o.update(n,m,a,b)}if(g){for(var r=0;r<j.length;r++){var s=j[r].__redom_id;(s in k)||unmount(d,l[s])}}setChildren(this,i);g&&(this.lookup=k);this.views=i};List.extend=function(a,b,c,d){return List.bind(List,a,b,c,d)};var Place=function c(a,b){this.el=text('');this.visible=!1;this.view=null;this._placeholder=this.el;this._View=a;this._initData=b};Place.prototype.update=function c(a,b){var d=this._placeholder,e=this.el.parentNode;if(a){if(!this.visible){var f=this._View,g=new f(this._initData);this.el=getEl(g.el);this.view=g;mount(e,g,d);unmount(e,d)}this.view.update&&this.view.update(b)}else this.visible&&(mount(e,d,this.view),unmount(e,this.view),this.el=d,this.view=null);this.visible=a};var Router=function d(a,b,c){this.el=ensureEl(a);this.Views=b;this.initData=c};Router.prototype.update=function c(a,b){if(a!==this.route){var d=this.Views,e=d[a];this.view=e&&new e(this.initData,b);this.route=a;setChildren(this.el,[this.view])}this.view&&this.view.update&&this.view.update(b,a)};function unqueue(a,b){var c=b.shift();c(function(){b.length?unqueue(a,b):(a.queueing=!1)})}var Deck=function a(){this.el=el('.deck');this.cards=[];this.queued=[];this.queueing=!1};Deck.prototype.mount=function b(a){mount(a,this);return this};Deck.prototype.queue=function b(a){this.queued.push(a);if(this.queueing){return this}this.queueing=!0;unqueue(this,this.queued);return this};Deck.prototype.stack=function a(){var b=this;return this.queue(function(a){b.cards.forEach(function(a,b){a.set({x:-b*a.d,y:-b*a.d,z:b})});a()})};Deck.prototype.wait=function b(a){return this.queue(function(b){return setTimeout(function(){return b()},a)})};Deck.prototype.shuffle=function c(){var d=this;return this.queue(function(a){d.cards.forEach(function(b,c){var d=Math.random()<0.5?1:-1,e=d*(Math.random()*50+50);b.tween({delay:c*2,duration:225,ease:'quadInOut',to:{x:e},precision:{x:1},onend:function(){c===0&&a()}})})}).queue(function(c){var e=d.cards.length-1;d.cards.sort(function(a,b){return Math.random()-0.5});d.cards.forEach(function(a,b){a.tween({delay:b*2,duration:225,ease:'quadInOut',to:{x:-b*a.d,y:-b*a.d,z:b},precision:{x:1,y:1,z:0},onend:function(){b===e&&c()}})})})};Deck.prototype.bySuit=function a(){var b=this;return this.queue(function(a){b.cards.forEach(function(a,b){a.tween({delay:500+b*30,duration:500,ease:'quartInOut',to:{x:(a.value-6)*125,y:(a.suit-1.5)*180},precision:{x:2,y:2,z:0}})})})};Deck.prototype.unshift=function b(a){this.cards.unshift(a);this.cards.forEach(function(a,b){a.set({z:b})});mount(this,a,this.cards[1]);return this};Deck.prototype.push=function b(a){var c=this.cards.length;a.set({z:c});this.cards.push(a);mount(this,a);return this};var easeInBy=function(a){return function(b){return Math.pow(b,a)}},easeOutBy=function(a){return function(b){return 1-Math.abs(Math.pow(b-1,a))}},easeInOutBy=function(a){return function(b){return b<0.5?easeInBy(a)(b*2)/2:easeOutBy(a)(b*2-1)/2+0.5}},quadIn=easeInBy(2),quadOut=easeOutBy(2),quadInOut=easeInOutBy(2),cubicIn=easeInBy(3),cubicOut=easeOutBy(3),cubicInOut=easeInOutBy(3),quartIn=easeInBy(4),quartOut=easeOutBy(4),quartInOut=easeInOutBy(4),quintIn=easeInBy(5),quintOut=easeOutBy(5),quintInOut=easeInOutBy(5),sineIn=function(a){return 1+Math.sin(Math.PI/2*a-Math.PI/2)},sineOut=function(a){return Math.sin(Math.PI/2*a)},sineInOut=function(a){return(1+Math.sin(Math.PI*a-Math.PI/2))/2},bounce=function(a){var b=7.5625,c=2.75;if(a<1/c){return b*a*a}if(a<2/c){a-=1.5/c;return b*a*a+0.75}if(a<2.5/c){a-=2.25/c;return b*a*a+0.9375}a-=2.625/c;return b*a*a+0.984375},easing=Object.freeze({quadIn:quadIn,quadOut:quadOut,quadInOut:quadInOut,cubicIn:cubicIn,cubicOut:cubicOut,cubicInOut:cubicInOut,quartIn:quartIn,quartOut:quartOut,quartInOut:quartInOut,quintIn:quintIn,quintOut:quintOut,quintInOut:quintInOut,sineIn:sineIn,sineOut:sineOut,sineInOut:sineInOut,bounce:bounce}),queue=[],requested=!1,rendering=!1,tweens=[];function tick(a,b){queue.push(a);if(rendering){if(requested){return}else requested=!0}else rendering=requestAnimationFrame(onRender)}function onRender(a){var b=queue.length;for(var c=0;c<b;c++)queue[c](a);queue.splice(0,b);requested?(requested=!1,rendering=requestAnimationFrame(onRender)):(rendering=!1)}function iterate(a){for(var b=0;b<tweens.length;b++){var c=tweens[b],d=c.startTime,e=c.duration,f=c.endTime,g=c.target,h=c.from,i=c.diff,j=c.ease,k=c.precision;if(a<d){continue}var l=a<f?(a-d)/e:1,m=easing[j]?easing[j](l):l;for(var n in h){var o=h[n]+i[n]*m;k[n]?(g[n]=parseFloat(o.toFixed(k[n]))):n in k?(g[n]=Math.round(o)):(g[n]=o)}g.render&&g.render();a>c.endTime&&(tweens.splice(b--,1),c.onend&&c.onend())}tweens.length&&tick(iterate)}function tween(a,b){var c=b.delay,d=b.duration,e=b.from;e===void 0&&(e={});var f=b.to;f===void 0&&(f={});var g=b.ease;g===void 0&&(g='linear');var h=b.precision;h===void 0&&(h={});var i=b.onend;tick(function(b){var j=b+c,k=j+d,l={};for(var m in e){var n=m in f;n||(f[m]=a[m])}for(var o in f){var p=o in e;p||(e[o]=a[o]);l[o]=f[o]-e[o]}var q={startTime:j,duration:d,endTime:k,ease:g,from:e,diff:l,precision:h,target:a,onend:i};tweens.length||tick(iterate);tweens.push(q)})}var SUITS='spades hearts clubs diamonds jokers'.split(' '),VALUES='a 2 3 4 5 6 7 8 9 10 j q k'.split(' '),Card=function b(a){var c=a/13|0,d=a%13,e="img/"+SUITS[c]+"/"+(c<4?VALUES[d]:d+1)+".svg";this.i=a;this.suit=c;this.value=d;this.img=e;this.stack=!0;this.data={};this.x=0;this.y=0;this.z=0;this.r=0;this.d=0.25;this.el=el('.card',{style:{backgroundImage:"url("+e+")"}})};Card.prototype.set=function b(a){var c=this;for(var d in a)c[d]=a[d];this.render();return this};Card.prototype.tween=function b(a){var c=a.delay;c===void 0&&(c=0);var d=a.duration;d===void 0&&(d=0);var e=a.ease,f=a.from,g=a.to,h=a.precision,i=a.stack,j=a.onend;this.stack=i;tween(this,{delay:c,duration:d,ease:e,from:f,to:g,precision:h,onend:j});return this};Card.prototype.render=function a(){var b=this,c=b.x,d=b.y,e=b.z,f=b.r,g="translate("+c+"px, "+d+"px)",h=f?" rotate("+f+"deg)":'';this.el.style.transform=g+h;this.el.style.zIndex=e;return this};var deck=new Deck({width:10,height:6});for(var i=0;i<55;i++){var card=new Card(i);deck.unshift(card)}deck.cards.reverse();deck.stack().wait(500).shuffle().shuffle().shuffle().bySuit();deck.mount(document.body)
